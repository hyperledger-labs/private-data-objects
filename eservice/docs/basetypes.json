{
    "$schema": "http://json-schema.org/schema#",
    "title": "Private Contract Requests",
    "id": "http://tradenet.org/pcontract/basetypes",
    "definitions": {
        "ecdsa-public-key": {
            "id": "#ecdsa-public-key",
            "description": [
                "an ECDSA public key from the SECP256k1 curve"
            ],
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "format": "PEM format"
        },
        "rsa-public-key": {
            "id": "#rsa-public-key",
            "description": [
                "a 2048-bit RSA public key"
            ],
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "format": "PEM format"
        },
        "encoded-hash": {
            "id": "#encoded-hash",
            "description": [
                "encoded sha256 hash"
            ],
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "format": "base64, urlsafe encoded 64 byte array"
        },
        "ecdsa-signature": {
            "id": "#ecdsa-signature",
            "description": [
                "an encoded signature generated by an ECDSA key"
            ],
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "format": "base64 url encoded ECDSA signature"
        },
        "contract-id": {
            "id": "#contract-id",
            "description": [
                "the identifier for a contract"
            ],
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "format": "base64, urlsafe encoded 64 byte array"
        },
        "transactor-id": {
            "id": "#transactor-id",
            "description": [
                "the identifier for a user",
                "for now this is equivalent to an ECDSA public key"
            ],
            "$ref": "#ecdsa-public-key"
        },
        "state-encryption-key": {
            "id": "#state-encryption-key",
            "description": [
                "an AES key encrypted with the enclaves private key",
                "used by an enclave to protect the state of a contract"
            ],
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "format": "base64 urlsafe encoded, no padding"
        },
        "contract-secret": {
            "id": "#contract-secret",
            "description": [
                "the concatenation of a 32 byte secret and a hex encoded 64 byte signature",
                "encrypted with the enclave's RSA key"
            ],
            "type": "string",
            "minLength": 22,
            "maxLength": 22,
            "format": "base64 urlsafe encoded, no padding"
        },
        "state-reference": {
            "id": "#state-reference",
            "description": [
                "a contract-id, state-hash pair that references a specific contract state",
                "used in contract dependencies"
            ],
            "type": "object",
            "properties": {
                "ContractID": {
                    "$ref": "#/pdo/basetypes/contract-id",
                    "required": true
                },
                "StateHash": {
                    "$ref": "#/pdo/basetypes/encoded-hash",
                    "required": true
                }
            }
        }
    }
}
